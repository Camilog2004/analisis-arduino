---
title: "trabajo2"
format: html
---

```{r}
bus <- read.csv("ENTRENAMIENTO/bus1.csv")
caminar <- read.csv("ENTRENAMIENTO/caminar1.csv")
cicla <- read.csv("ENTRENAMIENTO/cicla1.csv")
linea_o <- read.csv("ENTRENAMIENTO/lineaO1.csv")
metro1 <- read.csv("ENTRENAMIENTO/metro1.csv")
metro2 <- read.csv("ENTRENAMIENTO/metro2.csv")
metro3 <- read.csv("ENTRENAMIENTO/metro3.csv")
metro4 <- read.csv("ENTRENAMIENTO/metro4.csv")

```

```{r}
verificacación <- read.csv("VERIFICACIÓN/verificacion.csv")
linea_o
```

 

```{r}
library(tidyverse)
library(gridExtra)
library(knitr)
library(patchwork)
```

```{r}
summary(metro2)
```

```{r}
bus <- bus |>
  mutate(
    grupo_tiempo = as.POSIXct(timestamp / 1000, origin = "1970-01-01", tz = "UTC"),
    AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
  )

metro1 <- metro1 |>
  mutate(
    grupo_tiempo = as.POSIXct(timestamp / 1000, origin = "1970-01-01", tz = "UTC"),
    AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
  )


caminar <- caminar |>
  mutate(
    grupo_tiempo = as.POSIXct(timestamp / 1000, origin = "1970-01-01", tz = "UTC"),
    AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
  )

verificacación <- verificacación |>
  mutate(
    grupo_tiempo = as.POSIXct(timestamp / 1000, origin = "1970-01-01", tz = "UTC"),
    AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
  )

cicla <- cicla |>
  mutate(
    grupo_tiempo = as.POSIXct(timestamp / 1000, origin = "1970-01-01", tz = "UTC"),
    AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
  )

linea_o <- linea_o |>
  mutate(
    AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
  )

```

\

\

```{r}

```

```{r}
procesar_datos <- function(df) {
  df %>%
    # Eliminar filas donde AccX, AccY y AccZ son todos NA
    filter(!(is.na(AccX) & is.na(AccY) & is.na(AccZ))) %>%
    
    mutate(
      grupo_tiempo = as.POSIXct(floor(as.numeric(grupo_tiempo) * 40) / 40, origin = "1970-01-01"),
      AccT = sqrt(AccX^2 + AccY^2 + AccZ^2)
    ) %>%
    
    group_by(grupo_tiempo) %>%
    summarize(
      AccX = mean(AccX, na.rm = TRUE),
      AccY = mean(AccY, na.rm = TRUE),
      AccZ = mean(AccZ, na.rm = TRUE),
      AccT = mean(AccT, na.rm = TRUE),
      .groups = "drop"
    )
}
```

```{r}
bus <- procesar_datos(bus)

metro1<- procesar_datos(metro1)

caminar <-procesar_datos(caminar)

verificacación <-procesar_datos(verificacación)

cicla <- procesar_datos(cicla)
#linea_o <- procesar_datos(linea_o)
```

```{r}
#| warning: false
ggplot(metro1, aes(grupo_tiempo, AccT)) +
  geom_point(alpha = 0.3)+coord_cartesian(ylim = c(-10, 20))
```

```{r}
ggplot(bus, aes(grupo_tiempo, AccT)) +
  geom_point(alpha = 0.3)+coord_cartesian(ylim = c(-10, 20))
```

```{r}
ggplot(caminar, aes(grupo_tiempo, AccT)) +
  geom_point(alpha = 0.3)+coord_cartesian(ylim = c(-10, 20))
```

```{r}
ggplot(verificacación, aes(grupo_tiempo, AccT)) +
  geom_point(alpha = 0.3)+coord_cartesian(ylim = c(-10, 20))
```

```{r}
ggplot(linea_o, aes(timestamp, AccT)) +
  geom_point(alpha = 0.3)+coord_cartesian(ylim = c(-10, 20))
```

```{r}
ggplot(cicla, aes(grupo_tiempo, AccT)) +
  geom_point(alpha = 0.3)+coord_cartesian(ylim = c(-10, 20))
```

\

```{r}
library(e1071)
```

```{r}
curtosis <- kurtosis(linea_o$AccT, type = 2, na.rm = TRUE)

```

```{r}
hist(linea_o$AccT, breaks = 50)
boxplot(linea_o$AccT)
```

```{r}
ggplot(linea_o, aes(x = AccT)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "black", na.rm = TRUE) +
  labs(title = "Histograma de AccT", x = "AccT", y = "Frecuencia") +
  theme_minimal()
```

```{r}
ggplot(bus, aes(x = AccT)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "black", na.rm = TRUE) +
  labs(title = "Histograma de AccT", x = "AccT", y = "Frecuencia") +
  theme_minimal()
```

```{r}
ggplot(metro1, aes(x = AccT)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "black", na.rm = TRUE) +
  labs(title = "Histograma de AccT", x = "AccT", y = "Frecuencia") +
  theme_minimal()
```

```{r}
ggplot(cicla, aes(x = AccT)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "black", na.rm = TRUE) +
  labs(title = "Histograma de AccT", x = "AccT", y = "Frecuencia") +
  theme_minimal()
```

```{r}
library(dplyr)
library(e1071)  # Para kurtosis

resumen_estadisticas <- function(df, nombre) {
  df %>%
    summarise(
      Actividad = nombre,
      Media = mean(AccT, na.rm = TRUE),
      Varianza = var(AccT, na.rm = TRUE),
      Curtosis = kurtosis(AccT, type = 2, na.rm = TRUE)
    )
}

```

```{r}
# Suponiendo que ya tienes estas bases cargadas y procesadas con AccT:
res_bus <- resumen_estadisticas(bus, "Bus")
res_metro <- resumen_estadisticas(metro1, "Metro")
res_linea <- resumen_estadisticas(linea_o, "Linea O")
res_cicla <- resumen_estadisticas(cicla, "Cicla")
res_caminar <- resumen_estadisticas(caminar, "Caminar")

```

```{r}
tabla_final <- bind_rows(res_bus, res_metro, res_linea, res_cicla, res_caminar)
print(tabla_final)
```
